library(scales)
library(reshape2)
library(data.table)
library(RColorBrewer)
variation.antigen = rbindlist(all.antigen, idcol = TRUE)
all.antigen <- lapply(variation.list, function(.file) {
file.list = list.files(.file)
out.timeseries <- read.table(paste0(.file,"/out.trackAntigenSeries.txt"), header = TRUE)
out.timeseries
})
analysis.dir <- "~/Dropbox/Projects/mutantigen/"
variation.list = list.dirs(analysis.dir, full.names = TRUE, recursive = FALSE)
all.antigen <- lapply(variation.list, function(.file) {
file.list = list.files(.file)
out.timeseries <- read.table(paste0(.file,"/out.trackAntigenSeries.txt"), header = TRUE)
out.timeseries
})
variation.list
variation.list
all.antigen <- lapply(variation.list, function(.file) {
file.list = list.files(.file)
out.timeseries <- read.table(paste0(.file,"/out.trackAntigenSeries.txt"), header = TRUE)
out.timeseries
})
analysis.dir <- "~/Dropbox/Projects/mutantigen/variation"
variation.list = list.dirs(analysis.dir, full.names = TRUE, recursive = FALSE)
variation.list
analysis.dir <- "~/Dropbox/Projects/mutantigen/population_test/"
population.list = list.dirs(analysis.dir, full.names = FALSE, recursive = FALSE)
population.antigenFrequencies <- lapply(population.list, function(.file) {
out.timeseries <- read.table(paste0(analysis.dir,.file, "/out.antigenFrequencies.txt"), header = TRUE)
out.timeseries
})
names(population.antigenFrequencies) = population.list
names(population.antigenFrequencies) = population.list
population.antigenseries %>%
ggplot(aes(x = day, y = cumulativeTypes)) + geom_line()+
facet_wrap(~.id, scales = "free_y")
population.antigenFrequencies$antigentype = as.factor(population.antigenFrequencies$antigentype)
population.antigenFrequencies$antigentype = as.factor(population.antigenFrequencies$antigentype)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = simTime, y = frequency, group = antigentype, col = antigentype)) +
geom_line() + guides(col = FALSE)
population.antigenFrequencies = rbindlist(population.antigenFrequencies, idcol = TRUE)
names(population.antigenFrequencies) = population.list
population.antigenFrequencies = rbindlist(population.antigenFrequencies, idcol = TRUE)
library(plyr)
library(tidyverse)
library(ggplot2)
library(cowplot)
library(scales)
library(reshape2)
library(data.table)
library(RColorBrewer)
population.angitenFrequencies[[1]]
population.antigenFrequencies[[1]]
population.list
population.list = list.dirs(analysis.dir, full.names = FALSE, recursive = FALSE)
population.list
population.antigenFrequencies <- lapply(population.list, function(.file) {
out.timeseries <- read.table(paste0(analysis.dir,.file, "/out.antigenFrequencies.txt"), header = TRUE)
out.timeseries
})
names(population.antigenFrequencies) = population.list
population.antigenFrequencies = rbindlist(population.antigenFrequencies, idcol = TRUE)
population.antigenFrequencies$antigentype = as.factor(population.antigenFrequencies$antigentype)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = simTime, y = frequency, group = antigentype, col = antigentype)) +
geom_line() + guides(col = FALSE)
head(population.antigenFrequencies)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
summarize(unique(antigentype))
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency))
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) %<%
myColors <- colorRampPalette(brewer.pal(8, "Purples"))(3321)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) %<%
myColors <- colorRampPalette(brewer.pal(8, "Purples"))(3321)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) %<%
myColors <- colorRampPalette(brewer.pal(8, "Purples"))(3321)
myColors <- colorRampPalette(brewer.pal(8, "Purples"))(3321)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = simTime, y = frequency, group = antigentype, col = antigentype)) +
geom_line() + guides(col = FALSE) +
scale_color_manual(values = myColors)
myColors <- colorRampPalette(brewer.pal(8, "Accent"))(3321)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = simTime, y = frequency, group = antigentype, col = antigentype)) +
geom_line() + guides(col = FALSE) +
scale_color_manual(values = myColors)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = simTime, y = frequency, group = antigentype, col = antigentype)) +
geom_line() + guides(col = FALSE) +
scale_color_manual(values = myColors) -> antigenFrequencies.plot
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = simTime, y = frequency, group = antigentype, col = antigentype)) +
geom_line() + guides(col = FALSE) +
scale_color_manual(values = myColors) +
labs(x = "Frequency", y = "Years") -> antigenFrequencies.plot
save_plot(antigenFrequencies.plot, filename = "antigenFrequencies.pdf")
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = simTime, y = frequency, group = antigentype, col = antigentype)) +
geom_line() + guides(col = FALSE) +
scale_color_manual(values = myColors) +
labs(y = "Frequency", x = "Years") -> antigenFrequencies.plot
save_plot(antigenFrequencies.plot, filename = "antigenFrequencies.pdf", base_height = 4, base_aspect_ratio = 1.5)
population.timeseries <- lapply(population.list, function(.file) {
out.timeseries <- read.table(paste0(analysis.dir,.file, "/out.timseries.txt"), header = TRUE)
out.timeseries
})
population.timeseries <- lapply(population.list, function(.file) {
out.timeseries <- read.table(paste0(analysis.dir,.file, "/out.timeseries.txt"), header = TRUE)
out.timeseries
})
names(population.timeseries) = population.list
population.timeseries = rbindlist(population.timeseries, idcol = TRUE)
head(population.timeseries)
population.timeseries %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = simTime, y = totalI)) + geom_line()
population.timeseries %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = date, y = totalI)) + geom_line()
fancy_scientific <- function(l) {
# turn in to character string in scientific notation
l <- format(l, scientific = TRUE)
# quote the part before the exponent to keep all the digits
l <- gsub("^(.*)e", "'\\1'e", l)
# turn the 'e+' into plotmath format
l <- gsub("e", "%*%10^", l)
# return this as an expression
parse(text=l)
}
population.timeseries %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = date, y = totalI)) + geom_line()+
scale_y_continuous(labels = fancy_scientific)
population.timeseries %>%
filter(.id == "ten_sixth") %>%
ggplot(aes(x = date, y = totalI)) + geom_line()+
scale_y_continuous(labels = fancy_scientific) +
labs(x = "Years", y = "Infected") -> infected.dynamics
plot_grid(antigenFrequencies.plot, infected.dynamics)
plot_grid(antigenFrequencies.plot, infected.dynamics, ncol = 1)
plot_grid(antigenFrequencies.plot, infected.dynamics, ncol = 1) -> ten.sixth.dynamics
save_plot(ten.sixth.dynamics, filename = "ten.sixth.dynamics.pdf", base_height = 8, base_aspect_ratio = 1.2)
tree_sixth <- read_annotated(filename = paste0(analysis.dir,"/ten_sixth/out.trees.txt"), format = "newick")
library(phylotate)
tree_sixth <- read_annotated(filename = paste0(analysis.dir,"/ten_sixth/out.trees.txt"), format = "newick")
tree_third <- read_annotated(filename = paste0(analysis.dir,"/ten_third/out.trees.txt"), format = "newick")
tree_fourth <- read_annotated(filename = paste0(analysis.dir,"/ten_fourth/out.trees.txt"), format = "newick")
tree_fifth <- read_annotated(filename = paste0(analysis.dir,"/ten_fifth/out.trees.txt"), format = "newick")
pardefault <- par(no.readonly = T)
par(mfrow=c(2,2))
plot(tree_third, show.tip.label = FALSE)
plot(tree_sixth, show.tip.label = FALSE)
analysis.dir
library(phylotate)
tree_sixth <- read_annotated(filename = paste0(analysis.dir,"/ten_sixth/out.trees.txt"), format = "newick")
tree_third <- read_annotated(filename = paste0(analysis.dir,"/ten_third/out.trees.txt"), format = "newick")
tree_fourth <- read_annotated(filename = paste0(analysis.dir,"/ten_fourth/out.trees.txt"), format = "newick")
tree_fifth <- read_annotated(filename = paste0(analysis.dir,"/ten_fifth/out.trees.txt"), format = "newick")
plot(tree_third, show.tip.label = FALSE)
phylotate::plot(tree_third, show.tip.label = FALSE)
tree_third
phylotate::plot(tree_third, type = "phylogram", show.tip.label = FALSE)
plot(tree_third, type = "phylogram", show.tip.label = FALSE)
head(population.antigenFrequencies)
are greater than 5%
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency))
levels(population.antigenFrequencies$.id) <- c("ten_third", "ten_fourth", "ten_fifth", "ten_sixth")
levels(population.antigenFrequencies$.id) <- c("ten_third", "ten_fourth", "ten_fifth", "ten_sixth")
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency))
population.antigenFrequencies$.id <- factor(population.antigenFrequencies$.id, levels = c("ten_third", "ten_fourth", "ten_fifth", "ten_sixth")
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency))
out_antigenFrequencies %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) -> max.frequency
quantile(x = max.frequency$max.freq, probs = )
length(which(max.frequency$max.freq < .01))/3321 # Over 99% of novel antigenic mutations don't reach over 10%
%>%
ggplot(aes(max.freq)) + geom_histogram(bins = 100) + ylim(0, 500) + geom_vline(xintercept = .05)
max.frequency %>%
filter(max.freq > .05) -> threshold.frequencies
selected.antigens = threshold.frequencies$antigentype
out_antigenFrequencies %>%
filter(antigentype %in% selected.antigens) %>%
mutate(year = day/365) %>%
ggplot(aes(x = year, y = frequency, fill = antigentype)) +
geom_area() + guides(fill = FALSE) -> ci.frequency
save_plot(filename = "ci.frequency.pdf", ci.frequency)
############ Library phylotate
library(phylotate)
pardefault <- par(no.readonly = T)
par(mfrow=c(2,2))
tree_sixth <- read_annotated(filename = paste0(analysis.dir,"/ten_sixth/out.trees.txt"), format = "newick")
tree_third <- read_annotated(filename = paste0(analysis.dir,"/ten_third/out.trees.txt"), format = "newick")
tree_fourth <- read_annotated(filename = paste0(analysis.dir,"/ten_fourth/out.trees.txt"), format = "newick")
tree_fifth <- read_annotated(filename = paste0(analysis.dir,"/ten_fifth/out.trees.txt"), format = "newick")
tree_third
plot(tree_third, type = "phylogram", show.tip.label = FALSE)
plot(tree_sixth, show.tip.label = FALSE)
population.antigenFrequencies$.id <- factor(population.antigenFrequencies$.id, levels = c("ten_third", "ten_fourth", "ten_fifth", "ten_sixth")
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency))
out_antigenFrequencies %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) -> max.frequency
quantile(x = max.frequency$max.freq, probs = )
length(which(max.frequency$max.freq < .01))/3321 # Over 99% of novel antigenic mutations don't reach over 10%
%>%
ggplot(aes(max.freq)) + geom_histogram(bins = 100) + ylim(0, 500) + geom_vline(xintercept = .05)
max.frequency %>%
filter(max.freq > .05) -> threshold.frequencies
selected.antigens = threshold.frequencies$antigentype
out_antigenFrequencies %>%
filter(antigentype %in% selected.antigens) %>%
mutate(year = day/365) %>%
ggplot(aes(x = year, y = frequency, fill = antigentype)) +
geom_area() + guides(fill = FALSE) -> ci.frequency
save_plot(filename = "ci.frequency.pdf", ci.frequency)
############ Library phylotate
library(phylotate)
pardefault <- par(no.readonly = T)
par(mfrow=c(2,2))
tree_sixth <- read_annotated(filename = paste0(analysis.dir,"/ten_sixth/out.trees.txt"), format = "newick")
tree_third <- read_annotated(filename = paste0(analysis.dir,"/ten_third/out.trees.txt"), format = "newick")
tree_fourth <- read_annotated(filename = paste0(analysis.dir,"/ten_fourth/out.trees.txt"), format = "newick")
tree_fifth <- read_annotated(filename = paste0(analysis.dir,"/ten_fifth/out.trees.txt"), format = "newick")
tree_third
plot(tree_third, type = "phylogram", show.tip.label = FALSE)
plot(tree_sixth, show.tip.label = FALSE)
population.antigenFrequencies$.id <- factor(population.antigenFrequencies$.id, levels = c("ten_third", "ten_fourth", "ten_fifth", "ten_sixth")
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency))
out_antigenFrequencies %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) -> max.frequency
quantile(x = max.frequency$max.freq, probs = )
length(which(max.frequency$max.freq < .01))/3321 # Over 99% of novel antigenic mutations don't reach over 10%
%>%
ggplot(aes(max.freq)) + geom_histogram(bins = 100) + ylim(0, 500) + geom_vline(xintercept = .05)
max.frequency %>%
filter(max.freq > .05) -> threshold.frequencies
selected.antigens = threshold.frequencies$antigentype
out_antigenFrequencies %>%
filter(antigentype %in% selected.antigens) %>%
mutate(year = day/365) %>%
ggplot(aes(x = year, y = frequency, fill = antigentype)) +
geom_area() + guides(fill = FALSE) -> ci.frequency
save_plot(filename = "ci.frequency.pdf", ci.frequency)
############ Library phylotate
library(phylotate)
pardefault <- par(no.readonly = T)
par(mfrow=c(2,2))
tree_sixth <- read_annotated(filename = paste0(analysis.dir,"/ten_sixth/out.trees.txt"), format = "newick")
tree_third <- read_annotated(filename = paste0(analysis.dir,"/ten_third/out.trees.txt"), format = "newick")
tree_fourth <- read_annotated(filename = paste0(analysis.dir,"/ten_fourth/out.trees.txt"), format = "newick")
tree_fifth <- read_annotated(filename = paste0(analysis.dir,"/ten_fifth/out.trees.txt"), format = "newick")
tree_third
plot(tree_third, type = "phylogram", show.tip.label = FALSE)
plot(tree_sixth, show.tip.label = FALSE)
population.antigenFrequencies$antigentype = as.factor(population.antigenFrequencies$antigentype)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency))
population.antigenFrequencies$.id <- factor(population.antigenFrequencies$.id, levels = c("ten_third", "ten_fourth", "ten_fifth", "ten_sixth")
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency))
out_antigenFrequencies %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) -> max.frequency
quantile(x = max.frequency$max.freq, probs = )
length(which(max.frequency$max.freq < .01))/3321 # Over 99% of novel antigenic mutations don't reach over 10%
%>%
ggplot(aes(max.freq)) + geom_histogram(bins = 100) + ylim(0, 500) + geom_vline(xintercept = .05)
max.frequency %>%
filter(max.freq > .05) -> threshold.frequencies
selected.antigens = threshold.frequencies$antigentype
out_antigenFrequencies %>%
filter(antigentype %in% selected.antigens) %>%
mutate(year = day/365) %>%
ggplot(aes(x = year, y = frequency, fill = antigentype)) +
geom_area() + guides(fill = FALSE) -> ci.frequency
save_plot(filename = "ci.frequency.pdf", ci.frequency)
############ Library phylotate
library(phylotate)
pardefault <- par(no.readonly = T)
par(mfrow=c(2,2))
tree_sixth <- read_annotated(filename = paste0(analysis.dir,"/ten_sixth/out.trees.txt"), format = "newick")
tree_third <- read_annotated(filename = paste0(analysis.dir,"/ten_third/out.trees.txt"), format = "newick")
tree_fourth <- read_annotated(filename = paste0(analysis.dir,"/ten_fourth/out.trees.txt"), format = "newick")
tree_fifth <- read_annotated(filename = paste0(analysis.dir,"/ten_fifth/out.trees.txt"), format = "newick")
tree_third
plot(tree_third, type = "phylogram", show.tip.label = FALSE)
plot(tree_sixth, show.tip.label = FALSE)
population.antigenFrequencies$.id <- factor(population.antigenFrequencies$.id, levels = c("ten_third", "ten_fourth", "ten_fifth", "ten_sixth")
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency))
out_antigenFrequencies %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) -> max.frequency
quantile(x = max.frequency$max.freq, probs = )
length(which(max.frequency$max.freq < .01))/3321 # Over 99% of novel antigenic mutations don't reach over 10%
%>%
ggplot(aes(max.freq)) + geom_histogram(bins = 100) + ylim(0, 500) + geom_vline(xintercept = .05)
max.frequency %>%
filter(max.freq > .05) -> threshold.frequencies
selected.antigens = threshold.frequencies$antigentype
out_antigenFrequencies %>%
filter(antigentype %in% selected.antigens) %>%
mutate(year = day/365) %>%
ggplot(aes(x = year, y = frequency, fill = antigentype)) +
geom_area() + guides(fill = FALSE) -> ci.frequency
save_plot(filename = "ci.frequency.pdf", ci.frequency)
############ Library phylotate
library(phylotate)
pardefault <- par(no.readonly = T)
par(mfrow=c(2,2))
tree_sixth <- read_annotated(filename = paste0(analysis.dir,"/ten_sixth/out.trees.txt"), format = "newick")
tree_third <- read_annotated(filename = paste0(analysis.dir,"/ten_third/out.trees.txt"), format = "newick")
tree_fourth <- read_annotated(filename = paste0(analysis.dir,"/ten_fourth/out.trees.txt"), format = "newick")
tree_fifth <- read_annotated(filename = paste0(analysis.dir,"/ten_fifth/out.trees.txt"), format = "newick")
tree_third
plot(tree_third, type = "phylogram", show.tip.label = FALSE)
plot(tree_sixth, show.tip.label = FALSE)
population.antigenFrequencies$.id <- factor(population.antigenFrequencies$.id, levels = c("ten_third", "ten_fourth", "ten_fifth", "ten_sixth")
population.antigenFrequencies$.id <- factor(population.antigenFrequencies$.id, levels = c("ten_third", "ten_fourth", "ten_fifth", "ten_sixth"))
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency))
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram()+facet_wrap(~.id)
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram()+facet_wrap(~.id, scales = c("free_x", "free_y"))
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram()+facet_wrap(~.id, scales = c("free_x", "free_y"))
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram()+facet_wrap(~.id, scales = c("free"))
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bines = 50)+facet_wrap(~.id, scales = c("free"))
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50)+facet_wrap(~.id, scales = c("free"))
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50)+
facet_wrap(~.id, scales = c("free")) +
labs(x = "Maximum Frequency of Antigen")
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50)+
facet_wrap(~.id, scales = c("free")) +
labs(x = "Maximum Frequency of Antigen") -> antigen.histogram
save_plot(filename = "antigen.histogram.pdf", plot = antigen.histogram, base_height = 8)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50) +
scale_y_continuous(limits = c(0, 500))
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50) +
coord_cartesian(ylim = c(0, 500))
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50) +
scale_y_continuous(limits = c(0, 500))
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50) +
scale_y_continuous(limits = c(0, 100))
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50) +
coord_cartesian(ylim = c(0,100))
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50) +
coord_cartesian(ylim = c(0,100)) +
scale_x_continuous(breaks = seq(0, 1, .1))
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
group_by(antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50) +
coord_cartesian(ylim = c(0,100)) +
scale_x_continuous(breaks = seq(0, 1, .1)) -> zoomed.10_6
save_plot(filename = "antigen.histogram", plot = zoomed.10_6)
save_plot(filename = "antigen.histogram.pdf", plot = zoomed.10_6)
population.antigenFrequencies %>%
group_by(.id, antigentype) %>%
summarize(max.freq = max(frequency)) %>%
ggplot(aes(max.freq)) + geom_histogram(bins = 50)+
facet_wrap(~.id, scales = c("free")) +
labs(x = "Maximum Frequency of Antigen") -> antigen.histogram
save_plot(filename = "antigen.histogram.pdf", plot = antigen.histogram, base_height = 8)
save_plot(filename = "antigen.histogram106.pdf", plot = zoomed.10_6)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
head()
population.timeseries %>%
filter(.id == "ten_sixth") %>%
head()
population.timeseries %>%
filter(.id == "ten_sixth") %>%
mutate(prevalence = totalI/100,000) %>%
ggplot(aes(x = date, y = prevalence)) + geom_line()
population.timeseries %>%
filter(.id == "ten_sixth") %>%
mutate(prevalence = totalI/100,000) %>%
ggplot(aes(x = date, y = tmra)) + geom_line()
population.timeseries %>%
filter(.id == "ten_sixth") %>%
mutate(prevalence = totalI/100,000) %>%
ggplot(aes(x = date, y = tmrca)) + geom_line()
head(population.antigenFrequencies)
antigenFrequencies.plot
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
mutate(antigen.prevalence = round(frequency * infected)) %>%
head()
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
mutate(antigen.prevalence = round(frequency * infected)) %>%
ggplot(aes(x = simTime, y = antigen.prevalence, gorup = antigentype, col = antigentype)) +
geom_area() + guides(col = FALSE) +
scale_color_manual(values = myColors)
that are 10 and then
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
mutate(antigen.prevalence = round(frequency * infected)) %>%
ggplot(aes(x = simTime, y = antigen.prevalence, gorup = antigentype, col = antigentype)) +
geom_ribbon() + guides(col = FALSE) +
scale_color_manual(values = myColors)
e 10 and then
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
filter(day/10 == 0)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
filter((day %% 10 == 0))
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
filter((day %% 10 == 0)) %>%
mutate(antigen.prevalence = round(frequency * infected)) %>%
ggplot(aes(x = simTime, y = antigen.prevalence, gorup = antigentype, col = antigentype)) +
geom_area(position = 'stack') + guides(col = FALSE) +
scale_color_manual(values = myColors)
population.antigenFrequencies %>%
filter(.id == "ten_sixth") %>%
filter((day %% 10 == 0)) %>%
mutate(antigen.prevalence = round(frequency * infected)) %>%
ggplot(aes(x = simTime, y = antigen.prevalence, group = antigentype, col = antigentype)) +
geom_area(position = 'stack') + guides(col = FALSE) +
scale_color_manual(values = myColors)
